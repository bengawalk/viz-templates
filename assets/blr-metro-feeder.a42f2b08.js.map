{"version":3,"file":"blr-metro-feeder.a42f2b08.js","sources":["../../src/blr-metro-feeder/main.jsx"],"sourcesContent":["import * as React from \"react\";\nimport _ from \"lodash\";\nimport { createRoot } from \"react-dom/client\";\nimport mapboxgl from \"mapbox-gl\";\nimport '@material-design-icons/font/filled.css';\n\nimport { MAPBOX_TOKEN } from \"../utils/constants\";\n\nimport metroData from \"./metro_feeder.json\";\nimport circleFeatures from \"./circles_edited.json\";\n\nmapboxgl.accessToken = MAPBOX_TOKEN;\n\nconst CIRCLE_DIAMETER = 3;\n\nclass Container extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      lat: \"12.9487\",\n      lng: \"77.6145\",\n      zoom: \"11.56\",\n    };\n    this.mapContainer = React.createRef();\n    this.autoplayInterval = null;\n  }\n\n  componentDidMount() {\n    this.initMap();\n    this.map?.on(\"load\", () => {\n      this.renderMapData();\n      this.addMapEvents();\n    });\n  }\n\n  initMap = () => {\n    const { lng, lat, zoom } = this.state;\n    const map = new mapboxgl.Map({\n      container: this.mapContainer.current,\n      style: \"mapbox://styles/mapbox/streets-v12\",\n      center: [lng, lat],\n      zoom: zoom,\n      minZoom: 10,\n      maxZoom: 18,\n    });\n    map.dragRotate.disable();\n    map.touchZoomRotate.disableRotation();\n    this.map = map;\n  };\n\n  renderMapData = () => {\n    const routeFeatures = _.filter(metroData.features, f => f.geometry.type === \"LineString\");\n    const stopsFeatures = _.filter(metroData.features, f => f.geometry.type === \"Point\");\n\n    this.map.addSource(\"routes\", {\n      type: \"geojson\",\n      data: {\n        type: \"FeatureCollection\",\n        features: routeFeatures,\n      },\n    });\n    this.map.addSource(\"stops\", {\n      type: \"geojson\",\n      data: {\n        type: \"FeatureCollection\",\n        features: stopsFeatures,\n      },\n    });\n    this.map.addSource(\"circles\", {\n      type: \"geojson\",\n      data: circleFeatures,\n    });\n    this.map.addLayer({\n      id: 'circles',\n      source: 'circles',\n      type: 'fill',\n      paint: {\n        'fill-color': [\n          'match',\n          ['get', 'ref'],\n          'Purple',\n          '#01bfff',\n          'Green',\n          '#01bfff',\n          '#ffffff'\n        ],\n        'fill-opacity': 0.2\n      },\n    });\n    this.map.addLayer({\n      id: \"routes\",\n      source: \"routes\",\n      type: \"line\",\n      layout: {\n        \"line-join\": \"round\",\n        \"line-cap\": \"round\",\n      },\n      paint: {\n        \"line-color\": [\n          'match',\n          ['get', 'ref'],\n          'Purple',\n          '#5c0253',\n          'Green',\n          '#488f31',\n          '#ffffff'\n        ],\n        \"line-width\": 3,\n      },\n    });\n    this.map.addLayer({\n      id: 'stops',\n      source: 'stops',\n      type: 'circle',\n      paint: {\n        'circle-color': \"#ffffff\",\n        \"circle-stroke-color\": \"blue\",\n        \"circle-stroke-width\": 1,\n        'circle-radius': 4,\n      },\n    });\n  }\n\n  addMapEvents = () => {\n    this.map.on(\"move\", () => {\n      this.setState({\n        lng: this.map.getCenter().lng.toFixed(4),\n        lat: this.map.getCenter().lat.toFixed(4),\n        zoom: this.map.getZoom().toFixed(2),\n      });\n    });\n  }\n\n  render() {\n    return (\n      <div id=\"flyover-viz-wrapper\">\n        <div id=\"flyover-viz-map\" ref={this.mapContainer} />\n      </div>\n    );\n  }\n}\n\nconst root = createRoot(document.getElementById(\"root\"));\nroot.render(<Container />);\n"],"names":["mapboxgl","MAPBOX_TOKEN","Container","React.Component","props","__publicField","lng","lat","zoom","map","routeFeatures","_","metroData","f","stopsFeatures","circleFeatures","React.createRef","_a","React.createElement","root","createRoot"],"mappings":"ik4NAWAA,EAAS,YAAcC,EAIvB,MAAMC,UAAkBC,EAAAA,QAAAA,SAAgB,CACtC,YAAYC,EAAO,CACjB,MAAMA,CAAK,EAkBbC,EAAA,eAAU,IAAM,CACd,KAAM,CAAE,IAAAC,EAAK,IAAAC,EAAK,KAAAC,CAAA,EAAS,KAAK,MAC1BC,EAAM,IAAIT,EAAS,IAAI,CAC3B,UAAW,KAAK,aAAa,QAC7B,MAAO,qCACP,OAAQ,CAACM,EAAKC,CAAG,EACjB,KAAAC,EACA,QAAS,GACT,QAAS,EAAA,CACV,EACDC,EAAI,WAAW,UACfA,EAAI,gBAAgB,kBACpB,KAAK,IAAMA,CAAA,GAGbJ,EAAA,qBAAgB,IAAM,CACd,MAAAK,EAAgBC,EAAE,OAAOC,EAAU,SAAeC,GAAAA,EAAE,SAAS,OAAS,YAAY,EAClFC,EAAgBH,EAAE,OAAOC,EAAU,SAAeC,GAAAA,EAAE,SAAS,OAAS,OAAO,EAE9E,KAAA,IAAI,UAAU,SAAU,CAC3B,KAAM,UACN,KAAM,CACJ,KAAM,oBACN,SAAUH,CACZ,CAAA,CACD,EACI,KAAA,IAAI,UAAU,QAAS,CAC1B,KAAM,UACN,KAAM,CACJ,KAAM,oBACN,SAAUI,CACZ,CAAA,CACD,EACI,KAAA,IAAI,UAAU,UAAW,CAC5B,KAAM,UACN,KAAMC,CAAA,CACP,EACD,KAAK,IAAI,SAAS,CAChB,GAAI,UACJ,OAAQ,UACR,KAAM,OACN,MAAO,CACL,aAAc,CACZ,QACA,CAAC,MAAO,KAAK,EACb,SACA,UACA,QACA,UACA,SACF,EACA,eAAgB,EAClB,CAAA,CACD,EACD,KAAK,IAAI,SAAS,CAChB,GAAI,SACJ,OAAQ,SACR,KAAM,OACN,OAAQ,CACN,YAAa,QACb,WAAY,OACd,EACA,MAAO,CACL,aAAc,CACZ,QACA,CAAC,MAAO,KAAK,EACb,SACA,UACA,QACA,UACA,SACF,EACA,aAAc,CAChB,CAAA,CACD,EACD,KAAK,IAAI,SAAS,CAChB,GAAI,QACJ,OAAQ,QACR,KAAM,SACN,MAAO,CACL,eAAgB,UAChB,sBAAuB,OACvB,sBAAuB,EACvB,gBAAiB,CACnB,CAAA,CACD,CAAA,GAGHV,EAAA,oBAAe,IAAM,CACd,KAAA,IAAI,GAAG,OAAQ,IAAM,CACxB,KAAK,SAAS,CACZ,IAAK,KAAK,IAAI,UAAY,EAAA,IAAI,QAAQ,CAAC,EACvC,IAAK,KAAK,IAAI,UAAY,EAAA,IAAI,QAAQ,CAAC,EACvC,KAAM,KAAK,IAAI,QAAQ,EAAE,QAAQ,CAAC,CAAA,CACnC,CAAA,CACF,CAAA,GAhHD,KAAK,MAAQ,CACX,IAAK,UACL,IAAK,UACL,KAAM,OAAA,EAEH,KAAA,aAAeW,EAAAA,QAAAA,YACpB,KAAK,iBAAmB,IAC1B,CAEA,mBAAoB,OAClB,KAAK,QAAQ,GACRC,EAAA,KAAA,MAAA,MAAAA,EAAK,GAAG,OAAQ,IAAM,CACzB,KAAK,cAAc,EACnB,KAAK,aAAa,CAAA,EAEtB,CAoGA,QAAS,CAEL,OAAAC,EAAAA,QAAAA,cAAC,MAAI,CAAA,GAAG,qBACN,EAAAA,EAAAA,QAAAA,cAAC,MAAI,CAAA,GAAG,kBAAkB,IAAK,KAAK,YAAA,CAAc,CACpD,CAEJ,CACF,CAEA,MAAMC,EAAOC,EAAW,SAAS,eAAe,MAAM,CAAC,EACvDD,EAAK,OAAQD,EAAAA,QAAAA,cAAAhB,EAAA,IAAU,CAAE"}